<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenPix | O Segredo do Cofre</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Ajustes finos que o Tailwind padrão não cobre */
        body {
            /* Define a nova imagem realista do cofre em 4K como fundo */
            background-image: url('fundo-cofre-4k.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed; /* O fundo fica fixo ao rolar */
        }
        /* Efeito de vidro fosco para o painel central */
        .glass-panel {
            background: rgba(15, 23, 42, 0.75); /* Azul escuro com boa transparência */
            backdrop-filter: blur(12px); /* Desfoque do fundo mais forte */
            -webkit-backdrop-filter: blur(12px); /* Para Safari */
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); /* Sombra mais marcada */
        }
        .input-display {
            background: rgba(0, 0, 0, 0.6); /* Fundo mais escuro para o display */
            border: 1px solid rgba(234, 179, 8, 0.6); /* Borda dourada mais visível */
        }
    </style>
</head>
<body class="text-white flex flex-col items-center justify-center min-h-screen p-4 sm:p-8">

    <div class="fixed inset-0 bg-black/40 z-[-1]"></div>

    <main class="glass-panel p-6 sm:p-8 rounded-3xl w-full max-w-sm sm:max-w-md text-center relative overflow-hidden mx-auto">
        
        <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/25 to-transparent"></div>

        <header class="mb-6 sm:mb-8">
            <h1 class="text-4xl sm:text-5xl font-black tracking-tighter mb-2">
                <span class="text-yellow-500 drop-shadow-sm">OPEN</span><span class="text-white drop-shadow-sm">PIX</span>
            </h1>
            <p class="text-slate-300 text-xs sm:text-sm font-medium">Descubra a senha e leve o prêmio instantâneo.</p>
        </header>

        <div class="mb-6 sm:mb-8">
            <span class="text-[0.65rem] sm:text-xs uppercase tracking-[0.2em] text-slate-400 font-bold">Prêmio Acumulado</span>
            <div class="text-4xl sm:text-5xl font-mono font-black text-green-400 mt-2 drop-shadow-lg">
                R$ <span id="premio">500,30</span>
            </div>
        </div>

        <div class="input-display p-3 sm:p-4 rounded-xl mb-6 sm:mb-8 shadow-inner relative">
             <div class="absolute inset-0 bg-green-500/10 rounded-xl pointer-events-none z-0"></div>
            <input type="password" id="senha" maxlength="4" placeholder="----" 
                   class="bg-transparent relative z-10 text-center text-4xl sm:text-5xl font-mono font-bold tracking-[0.8rem] sm:tracking-[1rem] outline-none w-full text-green-400 placeholder-green-700/50 focus:placeholder-transparent transition-all">
        </div>

        <button onclick="fazerPagamento()" 
                class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-400 hover:to-yellow-500 text-slate-900 font-black text-base sm:text-lg py-3 sm:py-4 rounded-xl transition-all transform hover:scale-[1.02] shadow-lg shadow-yellow-500/25 active:scale-95">
            TENTAR POR R$ 1,00
        </button>

        <footer class="mt-6 sm:mt-8 text-slate-400 text-[0.65rem] sm:text-xs font-medium">
            <p>© 2026 OpenPix – Sistema Seguro via PIX</p>
        </footer>
    </main>

    <script>
        // Formata o valor inicial para o padrão brasileiro
        document.getElementById('premio').innerText = (500.30).toLocaleString('pt-BR', { minimumFractionDigits: 2 });

        function fazerPagamento() {
            alert("Simulação: Redirecionando para pagamento PIX...");
            // Em produção, aqui você chamaria sua API de pagamento
            setTimeout(() => {
                enviarTentativa();
            }, 1500); // Simula um tempinho de processamento
        }

        async function enviarTentativa() {
            const senhaInput = document.getElementById('senha');
            const senha = senhaInput.value;

            if (senha.length !== 4) {
                alert("Digite uma senha de 4 dígitos.");
                return;
            }

            try {
                // Nota: Isso vai falhar se o servidor backend não estiver rodando localmente
                // No Render, funcionará corretamente.
                const res = await fetch('/tentar', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ senha })
                });
                const data = await res.json();
                
                if (data.ganhou) {
                    alert(`PARABÉNS! VOCÊ GANHOU R$ ${data.premio.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}! O cofre foi aberto.`);
                    senhaInput.value = "";
                    location.reload();
                } else {
                    alert(data.msg);
                    senhaInput.value = "";
                    document.getElementById('premio').innerText = data.novoPremio.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
                }
            } catch (error) {
                console.error("Erro na requisição. Se estiver rodando apenas o HTML, isso é normal.", error);
                alert("Simulação: O servidor não respondeu. Em produção, isso validaria a senha.");
            }
        }
    </script>
</body>
</html>
